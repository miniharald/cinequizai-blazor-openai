@using CineQuizAI.Web.Components.Shared
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider
@inherits LayoutComponentBase

<div class="container py-2 d-flex justify-content-end">
    <LanguageSwitcher />
    @if (_isAuthenticated)
    {
        <form method="post" action="/api/auth/logout" class="ms-2" @formname="logout">
  <AppAntiforgeryToken />
            <button class="btn btn-outline-danger btn-sm" type="submit">Sign out</button>
        </form>
    }
</div>

@Body

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">🗙</a>
</div>

@code {
    private bool _isAuthenticated;

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthStateProvider.GetAuthenticationStateAsync();
        _isAuthenticated = authState.User.Identity?.IsAuthenticated == true;
    }
}
